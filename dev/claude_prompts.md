
## 2025-05-15.b ∆ replicate_aquamaps: add raster cache

Update all functions in @replicate_aquamaps that return a raster to cache the 
result as a tif using a top level `dir_cache`.

### Response

Let's finalize by updating the todo list to mark all tasks as complete:

⏺ Update Todos
  ⎿  ☒ Add helper function for standardized cache paths
     ☒ Add a top-level dir_cache parameter to the script
     ☒ Modify get_hcaf_raster() to use dir_cache
     ☒ Modify get_species_raster() to use dir_cache
     ☒ Modify replicate_sp_raster() to use dir_cache
     ☒ Update function calls in test sections to use dir_cache parameter

⏺ I've completed all the caching updates in replicate_aquamaps.qmd. Here's what I implemented:

  1. Added a top-level dir_cache parameter to the script
  2. Created a helper function get_cache_path() for standardized cache path generation
  3. Updated the following functions to use caching:
    - get_hcaf_raster() now caches and reuses the HCAF raster
    - get_species_raster() now caches original species rasters by species key
    - replicate_sp_raster() now caches replicated species rasters by species key
  4. Updated all the function calls in the test and validation sections to use the cache

  The cache is organized by raster type (hcaf, species, replicated) and includes status messages to
   inform users when data is loaded from cache vs. generated new. This implementation will
  significantly speed up repeated analyses by avoiding costly recalculations of rasters.

## 2025-05-15.a + replicate_aquamaps.qmd

Create a new Quarto document `replicate_aquamaps.qmd` that pulls from the
evaluated (`eval: true`) R chunks in @explore_interpolation.qmd, writes 
new functions and streamlines the replication of Aquamaps species rasters
for all species within `msens::ply_boemrgns` (not just Gulf of America). An 
output CSV file should be created with the following columns: `sp_key` (character)
and `r_matches` (boolean), which indicates whether the replicated Aquamaps raster 
`r_sp_new` matches `r_sp_old`.

### Response

I've created a new Quarto document replicate_aquamaps.qmd that builds upon
the exploratory work in explore_interpolation.qmd. The document
implements a streamlined workflow to replicate and validate AquaMaps
species distributions for all BOEM regions.

Key improvements in the new document:

1. Organized code into reusable functions for each step of the process
2. Used depth_min instead of depth_mean as suggested in your requirements
3. Implemented comprehensive validation across all species
4. Added comparison tools to analyze matches and non-matches
5. Generates a CSV file with validation results as requested

You can run this document to validate the AquaMaps replication process
across all species or a sample of species.
